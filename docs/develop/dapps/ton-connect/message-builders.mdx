# Preparing Messages

While using TON Connect you should build Message Body for Payload for various transactions. Here you can find most relatable examples for payload for using it in TON Connect SDKs.

:::warning
The page is under development.
:::


## Regular TON Transfer Example
TON Connect SDKs include wrappers for sending messages, making it easy to prepare regular transfers of Toncoins between two wallets. For example, a regular TON transfer using the TON Connect JS SDK can be executed as follows:

if (!connector.connected) {
    alert('Please connect wallet to send the transaction!');
}

```ts
if (!connector.connected) {
    alert('Please connect wallet to send the transaction!');
}

const transaction = {
    messages: [
        {
            address: "0:412410771DA82CBA306A55FA9E0D43C9D245E38133CB58F1457DFB8D5CD8892F", // destination address
            amount: "20000000" //Toncoin in nanotons
        }
    ]
}
```

For other custom tasks, a specific payload should be specified.


## TON Connect JS SDK Examples

### Transfer with comment

```js
const body = beginCell()
  .storeUint(0, 32) // write 32 zero bits to indicate that a text comment will follow
  .storeStringTail("Hello, TON!") // write our text comment
  .endCell();


await connector.sendTransaction({
  validUntil: Math.floor(Date.now() / 1000) + 360,
  messages: [
    {
      address: jettonWalletContract,
      amount: toNano("0.05"),
      payload: body.toBoc().toString("base64")
    }
  ]
})
```

### Jettons (Tokens) transaction

#### Mint Jetton

```js
let body = beginCell()
     //Mint message body
    .endCell()


await connector.sendTransaction({
  validUntil: Math.floor(Date.now() / 1000) + 360,
  messages: [
    {
      address: jettonWalletContract,
      amount: toNano("0.05"),
      payload: body.toBoc().toString("base64")
    }
  ]
})
```

- `jettonWalletAddress` - Address, JettonWallet address, that defined based on JettonMaser and Wallet contracts
- `balance` - Integer, amount of Toncoin for gas payments in nanotons.
- `body` - payload for the jettonContract, which defines what should be done
        -  `$$type`: string, "Mint" string (or corresponded op-code for Mint)
        -  `amount`: bigint, amount of Jettons should be minted


#### Jetton Transfer

The `body` for Jetton Transfer([TEP-74](https://github.com/ton-blockchain/TEPs/blob/master/text/0074-jettons-standard.md#1-transfer)) typically should be done according the following way:

```js
    import {beginCell, toNano} from '@ton/ton'
    // transfer#0f8a7ea5 query_id:uint64 amount:(VarUInteger 16) destination:MsgAddress
    // response_destination:MsgAddress custom_payload:(Maybe ^Cell)
    // forward_ton_amount:(VarUInteger 16) forward_payload:(Either Cell ^Cell)
    // = InternalMsgBody;

    const body = beginCell()
        .storeUint(0xf8a7ea5, 32)                 // jetton transfer op code
        .storeUint(0, 64)                         // query_id:uint64
        .storeCoins(1000000)                      // amount:(VarUInteger 16) -  Jetton amount for transfer (6 - jUSDT, 9 - default)
        .storeAddress(Wallet_DST)                 // destination:MsgAddress
        .storeAddress(Wallet_SRC)                 // response_destination:MsgAddress
        .storeUint(0, 1)                          // custom_payload:(Maybe ^Cell)
        .storeCoins(toNano(0.05))                 // forward_ton_amount:(VarUInteger 16)
        .storeUInt(0,1)                           // forward_payload:(Either Cell ^Cell)
        .endCell();
```

Next, sending the transaction with this body to jettonWalletContract destination executed:

```js
await connector.sendTransaction({
  validUntil: Math.floor(Date.now() / 1000) + 360,
  messages: [
    {
      address: jettonWalletContract,            // dst jetton wallet
      amount: toNano("0.05"),                   // for commission fees, excess will be returned
      payload: body.toBoc().toString("base64")
    }
  ]
})
```

- `jettonWalletAddress` - Address, JettonWallet address, that defined based on JettonMaser and Wallet contracts
- `balance` - Integer, amount of Toncoin for gas payments in nanotons.
- `body` - payload for the jettonContract


<details>
    <summary>Jetton Wallet State Init and Address preparation example</summary>
```js
import { Address, TonClient, beginCell, StateInit, storeStateInit } from '@ton/ton'

async function main() {
    const client = new TonClient({
        endpoint: 'https://toncenter.com/api/v2/jsonRPC',
        apiKey: 'put your api key'
    })

    const jettonWalletAddress = Address.parse('Sender_Jetton_Wallet');
    let jettonWalletDataResult = await client.runMethod(jettonWalletAddress, 'get_wallet_data');
    jettonWalletDataResult.stack.readNumber();
    const ownerAddress = jettonWalletDataResult.stack.readAddress();
    const jettonMasterAddress = jettonWalletDataResult.stack.readAddress();
    const jettonCode = jettonWalletDataResult.stack.readCell();
    const jettonData = beginCell()
        .storeCoins(0)
        .storeAddress(ownerAddress)
        .storeAddress(jettonMasterAddress)
        .storeRef(jettonCode)
        .endCell();

    const stateInit: StateInit = {
        code: jettonCode,
        data: jettonData
    }

    const stateInitCell = beginCell()
        .store(storeStateInit(stateInit))
        .endCell();

    console.log(new Address(0, stateInitCell.hash()));
}
```
</details>

#### Jetton Burn

The `body` for Jetton Burn([TEP-74](https://github.com/ton-blockchain/TEPs/blob/master/text/0074-jettons-standard.md#2-burn)) typically should be done according the following way:


```js
    import {beginCell, toNano} from '@ton/ton'
// burn#595f07bc query_id:uint64 amount:(VarUInteger 16)
//               response_destination:MsgAddress custom_payload:(Maybe ^Cell)
//               = InternalMsgBody;

    const body = beginCell()
        .storeUint(0x595f07bc, 32)                // jetton burn op code
        .storeUint(0, 64)                         // query_id:uint64
        .storeCoins(1000000)                      // amount:(VarUInteger 16) -  Jetton amount in decimal
        .storeAddress(Wallet_SRC)                 // response_destination:MsgAddress - owner's wallet
        .storeUint(0, 1)                          // custom_payload:(Maybe ^Cell) - w/o payload typically
        .endCell();
```


```js
await connector.sendTransaction({
  validUntil: Math.floor(Date.now() / 1000) + 360,
  messages: [
    {
      address: jettonWalletContract,
      amount: toNano("0.05"),
      payload: body.toBoc().toString("base64")
    }
  ]
})
```

- `jettonWalletAddress` - Address, jettonWalletContract - which desire to burn his jettons
- `amount` - Integer, amount of Toncoin for gas payments in nanotons.
- `body` - payload for the jetton wallet with the `burn#595f07bc` op code

### NFTs

#### Transfer NFT

Transfer the `NFTitem` to a new owner `NEW_OWNER_WALLET`.

```js
await connector.sendTransaction({
  validUntil: Math.floor(Date.now() / 1000) + 360,
  messages: [
    {
      address: NFTitem,
      amount: toNano("0.05"),
      payload: body.toBoc().toString("base64")
    }
  ]
})
```

- `NFTitem` - Address - The address of NFT item smart contract which we want transfer to a new owner `NEW_OWNER_WALLET`.
- `balance` - Integer, amount of Toncoin for gas payments in nanotons.
- `body` - payload for the NFT contract

`body` typically should be done according the following way:

```js
    import { Address, beginCell, Cell, toNano} from '@ton/ton'

//  transfer#5fcc3d14 query_id:uint64 new_owner:MsgAddress response_destination:MsgAddress custom_payload:(Maybe ^Cell)
//   forward_amount:(VarUInteger 16) forward_payload:(Either Cell ^Cell) = InternalMsgBody;

    const body = beginCell()
        .storeUint(0x5fcc3d14, 32)               // NFT transfer op code 0x5fcc3d14
        .storeUint(0, 64)                        // query_id:uint64
        .storeAddress(NEW_OWNER_WALLET)          // new_owner:MsgAddress
        .storeAddress(Wallet_DST)                // response_destination:MsgAddress
        .storeUint(0, 1)                         // custom_payload:(Maybe ^Cell)
        .storeCoins(toNano('0.000000001'))       // forward_amount:(VarUInteger 16)
        .storeUint(0,1)                          // forward_payload:(Either Cell ^Cell)
        .endCell();
```

`WALLET_DST` - Address - The address of the initial NFT owner for the receiving excess


#### Sale NFT Example

Here example of preparing message and transaction for sale on GetGems markteplace, according to contract [nft-fixprice-sale-v3r2.fc](https://github.com/getgems-io/nft-contracts/blob/main/packages/contracts/sources/nft-fixprice-sale-v3r2.fc)

#### Buy NFT Example


## TON Connect React UI (WIP)

[//]: # (#### Jettons)

[//]: # ()
[//]: # (Suppose, we specified simple hook built with ton-connect/react-ui useJettonContract.ts, which defines mint request from our application:)

[//]: # ()
[//]: # (<details>)

[//]: # (    <summary>Open entire script</summary>)

[//]: # ()
[//]: # (    ```ts)

[//]: # (    import { useEffect, useState } from "react";)

[//]: # (    import { Address, fromNano, OpenedContract, toNano } from "ton-core";)

[//]: # (    import {Mint, SampleJetton} from "../../build/SampleJetton/tact_SampleJetton";)

[//]: # (    import {JettonDefaultWallet} from "../../build/SampleJetton/tact_JettonDefaultWallet";)

[//]: # (    import { useAsyncInitialize } from "./useAsyncInitialize";)

[//]: # (    import { useTonClient } from "./useTonClient";)

[//]: # (    import { useTonConnect } from "./useTonConnect";)

[//]: # ()
[//]: # (    const sleep = &#40;time: number&#41; => new Promise&#40;&#40;resolve&#41; => setTimeout&#40;resolve, time&#41;&#41;)

[//]: # ()
[//]: # (    export function useJettonContract&#40;&#41; {)

[//]: # (    const {client} = useTonClient&#40;&#41;)

[//]: # (    const {wallet, sender} = useTonConnect&#40;&#41;)

[//]: # (    const [balance, setBalance] = useState<string | null>&#40;&#41;)

[//]: # ()
[//]: # (    const jettonContract = useAsyncInitialize&#40;async&#40;&#41;=>{)

[//]: # (    if&#40;!client || !wallet&#41; return;)

[//]: # ()
[//]: # (    const contract = SampleJetton.fromAddress&#40;Address.parse&#40;"EQB8StgTQXidy32a8xfu7j4HMoWYV0b0cFM8nXsP2cza_b7Y"&#41;&#41;)

[//]: # ()
[//]: # (    return client.open&#40;contract&#41; as OpenedContract<SampleJetton>)

[//]: # (}, [client, wallet]&#41;)

[//]: # ()
[//]: # (    const jettonWalletContract = useAsyncInitialize&#40;async&#40;&#41;=>{)

[//]: # (    if&#40;!jettonContract || !client&#41; return;)

[//]: # ()
[//]: # (    const jettonWalletAddress = await jettonContract.getGetWalletAddress&#40;)

[//]: # (    Address.parse&#40;Address.parse&#40;wallet!&#41;.toString&#40;&#41;&#41;)

[//]: # (    &#41;)

[//]: # ()
[//]: # (    return client.open&#40;JettonDefaultWallet.fromAddress&#40;jettonWalletAddress&#41;&#41;)

[//]: # (}, [jettonContract, client]&#41;)

[//]: # ()
[//]: # (    useEffect&#40;&#40;&#41;=>{)

[//]: # (    async function getBalance&#40;&#41; {)

[//]: # (    if&#40;!jettonWalletContract&#41; return)

[//]: # (    setBalance&#40;null&#41;)

[//]: # (    const balance = &#40;await jettonWalletContract.getGetWalletData&#40;&#41;&#41;.balance)

[//]: # (    setBalance&#40;fromNano&#40;balance&#41;&#41;)

[//]: # (    await sleep&#40;5000&#41;)

[//]: # (    getBalance&#40;&#41;)

[//]: # (})

[//]: # ()
[//]: # (    getBalance&#40;&#41;)

[//]: # ()
[//]: # (}, [jettonWalletContract]&#41;)

[//]: # ()
[//]: # (    return {)

[//]: # (    jettonWalletAddress: jettonWalletContract?.address.toString&#40;&#41;,)

[//]: # (    balance: balance,)

[//]: # (    mint: &#40;&#41; => {)

[//]: # (    const message: Mint = {)

[//]: # (    $$type: "Mint",)

[//]: # (    amount: 150n)

[//]: # (})

[//]: # ()
[//]: # (    jettonContract?.send&#40;sender, {)

[//]: # (    value: toNano&#40;"0.05"&#41;)

[//]: # (}, message&#41;)

[//]: # (})

[//]: # (})

[//]: # (})

[//]: # (    ```)

[//]: # ()
[//]: # (</details>)

[//]: # ()
[//]: # (```ts)

[//]: # (/// previous part)

[//]: # ( return {)

[//]: # (        jettonWalletAddress: jettonWalletContract?.address.toString&#40;&#41;,)

[//]: # (        balance: balance,)

[//]: # (        mint: &#40;&#41; => {)

[//]: # (            const message: Mint = {)

[//]: # (                $$type: "Mint",)

[//]: # (                amount: 150n)

[//]: # (            })

[//]: # ()
[//]: # (            jettonContract?.send&#40;sender, {)

[//]: # (                value: toNano&#40;"0.05"&#41;)

[//]: # (            }, message&#41;)

[//]: # (        })

[//]: # (    })

[//]: # (```)

[//]: # ()
[//]: # (Here our payload defined by sending `send&#40;&#41;` message with following specs:)

[//]: # ()
[//]: # (- `jettonWalletAddress` - Address, JettonWallet address, that defined based on JettonMaser and Wallet contracts)

[//]: # (- `balance` - Integer, amount of Toncoin for gas payments in nanotons.)

[//]: # (- `mint` - function, which invokes internal transfer from jettonContract&#40;jetton master&#41; to sender's Jetton Wallet)

[//]: # (- `sender` - wallet address, which requested mint and which will receive jettons on his Jetton Wallet)

[//]: # (- `value` - amount of Toncoins carried for gas payments between Jetton Master and new Jetton Wallet)

[//]: # (- `message` - payload for the jettonContract, which defines what should be done)

[//]: # (-  `$$type`: string, "Mint" string &#40;or corresponded op-code for Mint&#41;)

[//]: # (    -  `amount`: bigint, amount of Jettons should be minted)

[//]: # ()
[//]: # ()
[//]: # ()
[//]: # (```ts "title" = "destination address")

[//]: # ()
[//]: # ()
[//]: # (```)



## TON Connect Python SDK

### Jettons

#### Jetton Transfer

#### Jetton Mint

#### Jetton Burn

### NFTs

#### NFT Transfer

#### NFT Sale (getgems)

#### NFT Buy (getgems)

